<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    <title>Spencer's Blog</title>

    <meta name="author" content="Spencer's Blog" />
    <meta name="description" content="Linux, and Cloud, and Automation Tools! Oh My!">

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="/blog.css">
    <link rel="stylesheet" href="/pygments.css">
  </head>

  <body>

  <div class="blog-masthead navbar-fixed-top">
    <div class="container">
      <nav class="blog-nav">
        <a class="blog-nav-item" href="/">Home</a>
        <a class="blog-nav-item" href="#">About</a>
      </nav>
    </div>
  </div>

  <div class="container">
    <div class="blog-header">
      <h1 class="blog-title">Spencer's Blog</h1>
      <p class="lead blog-description">Linux, and Cloud, and Automation Tools! Oh My!</p>
    </div>

    <div class="row">
      <div class="col-sm-9 blog-main">
          <div class="blog-post">   
            <h2 class="blog-post-title">Warehouse Inventory With Python</h2>
            <p class="blog-post-meta">Written 03.10.2010 by Spencer</p>
            <hr>
              <p>Hi all,</p>

<p>So this week, I’ve been in a crunch to get some last minute cash for spring break. My Dad had a little opportunity for me to write a Python script for him to use at the office. The back story is basically that the warehouse where he works has to take inventory using some sort of hand-held scanning devices. </p>

<p>He wanted me to write a script that, when placed in a directory with any given number of output files from the devices, generates a document stating each file and how many cartons are in each pallet. Sounds like a perfect job for Python, right? Exactly right. It literally took me about 45 minutes to 1 hour and I had the thing completely off the ground running. I’ve decided to post it not so much because this exact program is really useful to anyone else, but because I definitely learned some cool I/O stuff while doing it.</p>

<p>First, I think it’s useful to get an idea of how the files looked coming in. They were basically Wordpad documents generated by Windows CE and didn’t have much format to them. Here’s a little example:</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">m464.pwd
{\pwd2\ansi{\*\pwdcomment
************************************************************************
*
* This is a Microsoft WordPad document.
*
* For further details visit the Microsoft Windows CE web site, at
*         http://www.microsoft.com/windowsce
* Or search MSDN for &#39;Microsoft WordPad&#39;
*
************************************************************************
}\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fnil\fcharset0 Tahoma;}}
{\colortbl ;}
\viewkind4\uc1\pard\cf0\f0\fs22 008022376\par
008022375\par
008022379\par
008022380\par
008022381\par
\par
}
^@</code></pre></div>

<p>As you can see, It’s a little hard to decipher. Also, keep in mind that this is not a full file as I didn’t want to post 600 lines in there. Anywhere there is a ‘\par’, except for the lone one at the end, there is a carton in the warehouse. All I had to do was figure out a way to add.</p>

<p>My program gave the following output:</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">Inventory Count
Generated: 03/09/2010 21:45:37
------------------------------------------------
Filename           # of Cartons
------------------------------------------------
m468                602
m466                286
m461                144
m465                245
m464                199</code></pre></div>

<p>So, as you can see, it seems to work pretty well. I can also imagine this is WAY easier than counting by hand. So, here is the code that converts one to the other. Be sure to notice the usefulness of the calls like getcwd(), which proved to be awesome for finding all the files in the directory.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#Spencer Smith</span>
<span class="c">#Inventory Calculator</span>
<span class="c">#Created 3/9/2010</span>
 
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">strftime</span>
 
<span class="c">#Name of output file</span>
<span class="n">filename2</span> <span class="o">=</span> <span class="s">&quot;inventory_count.txt&quot;</span>
 
<span class="c">#Get all files in current directory</span>
<span class="n">total_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">pwd_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
 
<span class="c">#Find all files with &#39;.pwd&#39; extension</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">total_files</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;.pwd&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
     <span class="n">pwd_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
 
<span class="c">#Return error to &#39;error.log&#39; if there are no &#39;.pwd&#39; files in the directory</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pwd_files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
  <span class="n">FILE</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;error.log&quot;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span>
  <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%m/</span><span class="si">%d</span><span class="s">/%Y %H:%M:%S&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; -- No files &#39;.pwd&#39; files in directory to read.&quot;</span><span class="p">)</span>
  <span class="n">FILE</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
 
<span class="c">#Open output file for writing</span>
<span class="n">OUT</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename2</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span>
 
<span class="c">#Create header</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Inventory Count</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Generated: &quot;</span><span class="o">+</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%m/</span><span class="si">%d</span><span class="s">/%Y %H:%M:%S&quot;</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;------------------------------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Filename           # of Cartons</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;------------------------------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
 
<span class="c">#Iterate through available &#39;.pwd&#39; files</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">pwd_files</span><span class="p">:</span>
 
<span class="c">#Open file for reading</span>
   <span class="n">FILE</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="s">&quot;r&quot;</span><span class="p">)</span>
   <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">suffix</span> <span class="o">=</span> <span class="s">&quot;\par&quot;</span>
 
<span class="c">#Search each line for &quot;\par&quot;. &quot;\par&quot; on the line means that there is a carton on this line.</span>
<span class="c">#Increment carton counter if found</span>
   <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">FILE</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c">#After reading all lines in file, write filename and count to output file.</span>
   <span class="n">OUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">                </span><span class="si">%d</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span><span class="n">counter</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="c">#Close current file and reset.</span>
   <span class="n">FILE</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
 
<span class="c">#Close output file so that it can be read.</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></code></pre></div>

<p>Enjoy! Hope someone finds it useful!</p>

            <hr>
            <a href="/"><< Back</a>
          </div>
      </div>

      <div class="col-sm-3 blog-sidebar">
        <div class="sidebar-module sidebar-module-inset">
          <h4>About</h4>
          <p>Hi, welcome to my personal blog. I plan to use this site to document interesting things I've learned on personal projects. I work extensively with OpenStack and Linux at work and tend to try new functionality at home. Because I'm forgetful, I'll write up the the cool things I find in order to keep from asking myself, "How in the heck did I do that?!?!" over and over again.</p>
        </div>
        <div class="sidebar-module sidebar-module-inset">
          <h4>Contact Info</h4>
          <ol class="list-unstyled">
            <li><a href="https://github.com/rsmitty" target="_blank">Github</a></li>
            <li><a href="http://lnkd.in/feXbBV" target="_blank">LinkedIn</a></li>
          </ol>
        </div>
      </div>

    </div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>


  </body>
</html>
